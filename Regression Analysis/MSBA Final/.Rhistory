hist(CatLotData2$`LOT SIZE`)
CatLotData2$LotCat<-cut(CatLotData2$`LOT SIZE`, c(0,2500,5000,7500,10000,25000,32000,Inf))
View(CatLotData2)
CatLotData2$NeighCat<-factor(CatLotData2$LOCATION)
LocCount <- as.data.frame(table(CatLotData2$LOCATION))
summary(CatLotData2$NeighCat)
summary(CatLotData2$PRICE)
Prices<-aggregate(PRICE ~ NeighCat, CatLotData2, mean)
Prices[with(Prices, order(PRICE)),]
show(LocCount)
CatLotData3<-CatLotData2[!(CatLotData2$LOCATION=="Charleston" | CatLotData2$LOCATION=="Bremerton"),]
CatLotData3<-CatLotData2[!(CatLotData2$LOCATION=="Kitsap Lake" | CatLotData2$LOCATION=="West Bremerton"),]
summary(CatLotData2$NeighCat)
summary(CatLotData2$PRICE)
CatLotData3$NeighCat2 <- recode(CatLotData3$NeighCat, 'c("Kitsap Lake", "West Bremerton") = "West Bremerton"; c("Charleston", "West Bremerton") = "West Bremerton";')
View(CatLotData3)
summary(CatLotData3$NeighCat)
summary(CatLotData3$PRICE)
Prices2<-aggregate(PRICE ~ NeighCat2, CatLotData3, mean)
Prices2[with(Prices2, order(PRICE)),]
LocCount2 <- as.data.frame(table(CatLotData3$NeighCat2))
show(LocCount2)
CatLotData3$NeighCat2<-factor(CatLotData3$NeighCat2,levels=c('West Bremerton', 'West Hills', 'Bremerton', 'Navy Yard City'))     # this is to enforce a order to the reference for the factor variable
summary(CatLotData3$NeighCat2)
CatFit1<-lm(PRICE~BATHS+BEDS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit1)
vif(CatFit1)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData2)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat, data=CatLotData)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData2)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = normalizePath("C:/Users/randa/Dropbox/Masters/Autumn/TBANLT 540 Applied Regression Analysis/Categorical Variables Lab"))
options(scipen=10000)
options(digits = 5)
library(readxl)
library(plyr)
library(tidyverse)
library(car)
CatLotData <- read_excel("98312_Redfin_2021.xlsx")
View(CatLotData)
CatLotData2 <- CatLotData %>% select(PRICE,BEDS, BATHS,`SQUARE FEET`,`LOT SIZE`,`YEAR BUILT`,`LOCATION`)
summary(CatLotData2)
show(CatLotData2)
CatLotData2 <-  CatLotData2[complete.cases(CatLotData2), ]
summary(CatLotData2)
hist(CatLotData2$`LOT SIZE`)
CatLotData2$LotCat<-cut(CatLotData2$`LOT SIZE`, c(0,2500,5000,7500,10000,25000,32000,Inf))
View(CatLotData2)
CatLotData2$NeighCat<-factor(CatLotData2$LOCATION)
LocCount <- as.data.frame(table(CatLotData2$LOCATION))
summary(CatLotData2$NeighCat)
summary(CatLotData2$PRICE)
Prices<-aggregate(PRICE ~ NeighCat, CatLotData2, mean)
Prices[with(Prices, order(PRICE)),]
show(LocCount)
CatLotData3<-CatLotData2[!(CatLotData2$LOCATION=="Charleston" | CatLotData2$LOCATION=="Bremerton"),]
CatLotData3<-CatLotData2[!(CatLotData2$LOCATION=="Kitsap Lake" | CatLotData2$LOCATION=="West Bremerton"),]
summary(CatLotData2$NeighCat)
summary(CatLotData2$PRICE)
CatLotData3$NeighCat2 <- recode(CatLotData3$NeighCat, 'c("Kitsap Lake", "West Bremerton") = "West Bremerton"; c("Charleston", "West Bremerton") = "West Bremerton";')
View(CatLotData3)
summary(CatLotData3$NeighCat)
summary(CatLotData3$PRICE)
Prices2<-aggregate(PRICE ~ NeighCat2, CatLotData3, mean)
Prices2[with(Prices2, order(PRICE)),]
LocCount2 <- as.data.frame(table(CatLotData3$NeighCat2))
show(LocCount2)
CatLotData3$NeighCat2<-factor(CatLotData3$NeighCat2,levels=c('West Bremerton', 'West Hills', 'Bremerton', 'Navy Yard City'))     # this is to enforce a order to the reference for the factor variable
summary(CatLotData3$NeighCat2)
CatFit1<-lm(PRICE~BATHS+BEDS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit1)
vif(CatFit1)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData2)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat3, data=CatLotData2)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = normalizePath("C:/Users/randa/Dropbox/Masters/Autumn/TBANLT 540 Applied Regression Analysis/Categorical Variables Lab"))
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData2)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = normalizePath("C:/Users/randa/Dropbox/Masters/Autumn/TBANLT 540 Applied Regression Analysis/Categorical Variables Lab"))
options(scipen=10000)
options(digits = 5)
library(readxl)
library(plyr)
library(tidyverse)
library(car)
CatLotData <- read_excel("98312_Redfin_2021.xlsx")
View(CatLotData)
CatLotData2 <- CatLotData %>% select(PRICE,BEDS, BATHS,`SQUARE FEET`,`LOT SIZE`,`YEAR BUILT`,`LOCATION`)
summary(CatLotData2)
show(CatLotData2)
CatLotData2 <-  CatLotData2[complete.cases(CatLotData2), ]
summary(CatLotData2)
hist(CatLotData2$`LOT SIZE`)
CatLotData2$LotCat<-cut(CatLotData2$`LOT SIZE`, c(0,2500,5000,7500,10000,12500,15000,Inf))
View(CatLotData2)
CatLotData2$NeighCat<-factor(CatLotData2$LOCATION)
LocCount <- as.data.frame(table(CatLotData2$LOCATION))
summary(CatLotData2$NeighCat)
summary(CatLotData2$PRICE)
Prices<-aggregate(PRICE ~ NeighCat, CatLotData2, mean)
Prices[with(Prices, order(PRICE)),]
show(LocCount)
CatLotData3<-CatLotData2[!(CatLotData2$LOCATION=="Charleston" | CatLotData2$LOCATION=="Bremerton"),]
CatLotData3<-CatLotData2[!(CatLotData2$LOCATION=="Kitsap Lake" | CatLotData2$LOCATION=="West Bremerton"),]
summary(CatLotData2$NeighCat)
summary(CatLotData2$PRICE)
CatLotData3$NeighCat2 <- recode(CatLotData3$NeighCat, 'c("Kitsap Lake", "West Bremerton") = "West Bremerton"; c("Charleston", "Bremerton") = "Bremerton";')
View(CatLotData3)
summary(CatLotData3$NeighCat)
summary(CatLotData3$PRICE)
Prices2<-aggregate(PRICE ~ NeighCat2, CatLotData3, mean)
Prices2[with(Prices2, order(PRICE)),]
LocCount2 <- as.data.frame(table(CatLotData3$NeighCat2))
show(LocCount2)
CatLotData3$NeighCat2<-factor(CatLotData3$NeighCat2,levels=c('West Bremerton', 'West Hills', 'Bremerton', 'Navy Yard City'))     # this is to enforce a order to the reference for the factor variable
summary(CatLotData3$NeighCat2)
CatFit1<-lm(PRICE~BATHS+BEDS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit1)
vif(CatFit1)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData2)
CatFit3<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData2)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2Bremerton , data=CatLotData2)
CatFit1<-lm(PRICE~BATHS+BEDS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit1)
vif(CatFit1)
vif(CatFit1)
vif(CatFit1)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData2)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData2)
CatFit1<-lm(PRICE~BATHS+BEDS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit1)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2Bremerton , data=CatLotData2)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2Bremerton, data=CatLotData2)
CatLotData3$NeighCat2<-factor(CatLotData3$NeighCat2,levels=c('West Hills', 'Bremerton', 'Navy Yard City'))     # this is to enforce a order to the reference for the factor variable
summary(CatLotData3$NeighCat2)
CatFit1<-lm(PRICE~BATHS+BEDS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit1)
vif(CatFit1)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData2)
CatLotData3<-CatLotData2[!(CatLotData2$LOCATION=="Charleston" | CatLotData2$LOCATION=="Bremerton"),]
CatLotData3<-CatLotData2[!(CatLotData2$LOCATION=="Kitsap Lake" | CatLotData2$LOCATION=="West Bremerton"),]
summary(CatLotData2$NeighCat)
summary(CatLotData2$PRICE)
CatLotData3$NeighCat2 <- recode(CatLotData3$NeighCat, 'c("Kitsap Lake", "West Hills") = "West Hills"; c("Charleston", "Bremerton") = "Bremerton";')
View(CatLotData3)
summary(CatLotData3$NeighCat)
summary(CatLotData3$PRICE)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData2)
CatLotData3<-CatLotData2[!(CatLotData2$LOCATION=="Charleston" | CatLotData2$LOCATION=="Bremerton"),]
CatLotData3<-CatLotData2[!(CatLotData2$LOCATION=="Kitsap Lake" | CatLotData2$LOCATION=="West Hills"),]
summary(CatLotData2$NeighCat)
summary(CatLotData2$PRICE)
CatLotData3$NeighCat2 <- recode(CatLotData3$NeighCat, 'c("Kitsap Lake", "West Hills") = "West Hills"; c("Charleston", "Bremerton") = "Bremerton";')
View(CatLotData3)
summary(CatLotData3$NeighCat)
summary(CatLotData3$PRICE)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData2)
CatLotData3$NeighCat2<-factor(CatLotData3$NeighCat2,levels=c('West Hills', 'Bremerton', 'Navy Yard City', 'Charleston'))     # this is to enforce a order to the reference for the factor variable
summary(CatLotData3$NeighCat2)
CatLotData3<-CatLotData2[!(CatLotData2$LOCATION=="Charleston" | CatLotData2$LOCATION=="Bremerton"),]
CatLotData3<-CatLotData2[!(CatLotData2$LOCATION=="Kitsap Lake" | CatLotData2$LOCATION=="West Hills"),]
summary(CatLotData2$NeighCat)
summary(CatLotData2$PRICE)
CatLotData3$NeighCat2 <- recode(CatLotData3$NeighCat, 'c("Kitsap Lake", "West Hills") = "West Hills"; c("Charleston", "Bremerton") = "Bremerton";')
View(CatLotData3)
summary(CatLotData3$NeighCat)
summary(CatLotData3$PRICE)
Prices2<-aggregate(PRICE ~ NeighCat2, CatLotData3, mean)
Prices2[with(Prices2, order(PRICE)),]
LocCount2 <- as.data.frame(table(CatLotData3$NeighCat2))
show(LocCount2)
Prices2<-aggregate(PRICE ~ NeighCat2, CatLotData3, mean)
Prices2<-aggregate(PRICE ~ NeighCat2, CatLotData3, mean)
```{r}
CatLotData3<-CatLotData2[!(CatLotData2$LOCATION=="Charleston" | CatLotData2$LOCATION=="Bremerton"),]
CatLotData3<-CatLotData2[!(CatLotData2$LOCATION=="Kitsap Lake" | CatLotData2$LOCATION=="West Hills"),]
summary(CatLotData2$NeighCat)
summary(CatLotData2$PRICE)
CatLotData3$NeighCat2 <- recode(CatLotData3$NeighCat, 'c("Kitsap Lake", "West Hills") = "West Hills"; c("Charleston", "Bremerton") = "Bremerton";')
View(CatLotData3)
summary(CatLotData3$NeighCat)
summary(CatLotData3$PRICE)
Prices2<-aggregate(PRICE ~ NeighCat2, CatLotData3, mean)
Prices2[with(Prices2, order(PRICE)),]
LocCount2 <- as.data.frame(table(CatLotData3$NeighCat2))
show(LocCount2)
CatLotData3<-CatLotData2[!(CatLotData2$LOCATION=="Charleston" | CatLotData2$LOCATION=="Bremerton"),]
CatLotData3<-CatLotData2[!(CatLotData2$LOCATION=="Kitsap Lake" | CatLotData2$LOCATION=="West Hills"),]
summary(CatLotData2$NeighCat)
summary(CatLotData2$PRICE)
CatLotData3$NeighCat2 <- recode(CatLotData3$NeighCat, 'c("Kitsap Lake", "West Hills") = "West Hills"; c("Charleston", "Bremerton") = "Bremerton";')
View(CatLotData3)
summary(CatLotData3$NeighCat)
summary(CatLotData3$PRICE)
summary(CatLotData3$NeighCat)
CatLotData3<-CatLotData2[!(CatLotData2$LOCATION=="Charleston" | CatLotData2$LOCATION=="Bremerton"),]
CatLotData3<-CatLotData2[!(CatLotData2$LOCATION=="Kitsap Lake" | CatLotData2$LOCATION=="West Hills"),]
summary(CatLotData2$NeighCat)
summary(CatLotData2$PRICE)
CatLotData3$NeighCat2 <- recode(CatLotData3$NeighCat, 'c("Kitsap Lake", "West Hills") = "West Hills"; c("Charleston", "Bremerton") = "Bremerton";')
View(CatLotData3)
summary(CatLotData3$NeighCat)
summary(CatLotData3$PRICE)
Prices2<-aggregate(PRICE ~ NeighCat2, CatLotData3, mean)
Prices2[with(Prices2, order(PRICE)),]
LocCount2 <- as.data.frame(table(CatLotData3$NeighCat2))
show(LocCount2)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit2)
anova(CatFit1, CatFit2)
CatFit3<-lm(PRICE~BATHS+BEDS+`SQUARE FEET`+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit3)
anova(CatFit1,CatFit3)
CatFit4<-lm(PRICE~BATHS+BEDS+`SQUARE FEET`+`YEAR BUILT`+ LotCat, data=CatLotData3)
summary(CatFit4)
anova(CatFit1,CatFit4)
CatFit5<-lm(PRICE~BATHS+`SQUARE FEET`+`YEAR BUILT`+ LotCat+ NeighCat2, data=CatLotData3)
summary(CatFit5)
anova(CatFit1, CatFit5)
summary(CatFit1)
summary(CatFit5)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = normalizePath("C:/Users/randa/Dropbox/Masters/Autumn/TBANLT 540 Applied Regression Analysis/Categorical Variables Lab"))
CatLotData <- read_excel("98312_Redfin_2021.xlsx")
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit2)
anova(CatFit1, CatFit2)
CatFit3<-lm(PRICE~BATHS+BEDS+`SQUARE FEET`+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit3)
anova(CatFit1,CatFit3)
CatFit4<-lm(PRICE~BATHS+BEDS+`SQUARE FEET`+`YEAR BUILT`+ LotCat, data=CatLotData3)
summary(CatFit4)
anova(CatFit1,CatFit4)
CatFit5<-lm(PRICE~BATHS+`SQUARE FEET`+`YEAR BUILT`+ LotCat+ NeighCat2, data=CatLotData3)
summary(CatFit5)
anova(CatFit1, CatFit5)
summary(CatFit1)
summary(CatFit5)
vif(CatFit1)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = normalizePath("C:/Users/randa/Dropbox/Masters/Autumn/TBANLT 540 Applied Regression Analysis/Categorical Variables Lab"))
options(scipen=10000)
options(digits = 5)
library(readxl)
library(plyr)
library(tidyverse)
library(car)
CatLotData <- read_excel("98312_Redfin_2021.xlsx")
View(CatLotData)
CatLotData2 <- CatLotData %>% select(PRICE,BEDS, BATHS,`SQUARE FEET`,`LOT SIZE`,`YEAR BUILT`,`LOCATION`)
summary(CatLotData2)
show(CatLotData2)
CatLotData2 <-  CatLotData2[complete.cases(CatLotData2), ]
summary(CatLotData2)
hist(CatLotData2$`LOT SIZE`)
CatLotData2$LotCat<-cut(CatLotData2$`LOT SIZE`, c(0,2500,5000,7500,10000,12500,15000,Inf))
View(CatLotData2)
CatLotData2$NeighCat<-factor(CatLotData2$LOCATION)
LocCount <- as.data.frame(table(CatLotData2$LOCATION))
summary(CatLotData2$NeighCat)
summary(CatLotData2$PRICE)
Prices<-aggregate(PRICE ~ NeighCat, CatLotData2, mean)
Prices[with(Prices, order(PRICE)),]
show(LocCount)
#Remove charleston or bremerton
CatLotData3<-CatLotData2[!(CatLotData2$LOCATION=="Charleston" | CatLotData2$LOCATION=="Kitsap Lake"),]
summary(CatLotData2$NeighCat)
summary(CatLotData2$PRICE)
CatLotData3$NeighCat2 <- recode(CatLotData3$NeighCat, 'c("Kitsap Lake", "West Bremerton") = "West Bremerton"; c("Charleston", "Bremerton") = "Bremerton";')
View(CatLotData3)
summary(CatLotData3$NeighCat)
Prices2<-aggregate(PRICE ~ NeighCat2, CatLotData3, mean)
summary(CatLotData3$NeighCat)
summary(Prices2)
Prices2[with(Prices2, order(PRICE)),]
LocCount2 <- as.data.frame(table(CatLotData3$NeighCat2))
show(LocCount2)
CatLotData3$NeighCat2<-factor(CatLotData3$NeighCat2,levels=c('West Bremerton', 'West Hills', 'Bremerton', 'Navy Yard City'))     # this is to enforce a order to the reference for the factor variable
summary(CatLotData3$NeighCat2)
CatFit1<-lm(PRICE~BATHS+BEDS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit1)
vif(CatFit1)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit2)
anova(CatFit1, CatFit2)
CatFit3<-lm(PRICE~BATHS+BEDS+`SQUARE FEET`+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit3)
anova(CatFit1,CatFit3)
CatFit4<-lm(PRICE~BATHS+BEDS+`SQUARE FEET`+`YEAR BUILT`+ LotCat, data=CatLotData3)
summary(CatFit4)
anova(CatFit1,CatFit4)
CatFit5<-lm(PRICE~BATHS+`SQUARE FEET`+`YEAR BUILT`+ LotCat+ NeighCat2, data=CatLotData3)
summary(CatFit5)
anova(CatFit1, CatFit5)
summary(CatFit1)
summary(CatFit5)
CatLotData3$NeighCat2<-factor(CatLotData3$NeighCat2,levels=c('West Bremerton', 'Bremerton', 'West Hills', 'Navy Yard City'))     # this is to enforce a order to the reference for the factor variable
summary(CatLotData3$NeighCat2)
CatFit1<-lm(PRICE~BATHS+BEDS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit1)
vif(CatFit1)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit2)
anova(CatFit1, CatFit2)
CatFit3<-lm(PRICE~BATHS+BEDS+`SQUARE FEET`+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit3)
anova(CatFit1,CatFit3)
CatFit4<-lm(PRICE~BATHS+BEDS+`SQUARE FEET`+`YEAR BUILT`+ LotCat, data=CatLotData3)
summary(CatFit4)
anova(CatFit1,CatFit4)
CatFit5<-lm(PRICE~BATHS+`SQUARE FEET`+`YEAR BUILT`+ LotCat+ NeighCat2, data=CatLotData3)
summary(CatFit5)
anova(CatFit1, CatFit5)
summary(CatFit1)
summary(CatFit5)
summary(CatFit2)
summary(CatFit2)
anova(CatFit1, CatFit2)
summary(CatFit3)
anova(CatFit1,CatFit3)
summary(CatFit4)
anova(CatFit1,CatFit4)
summary(CatFit5)
anova(CatFit1, CatFit5)
#Remove charleston or bremerton
CatLotData3<-CatLotData2[!(CatLotData2$LOCATION=="Charleston" | CatLotData2$LOCATION=="Kitsap Lake"),]
summary(CatLotData2$NeighCat)
summary(CatLotData2$PRICE)
CatLotData3$NeighCat2 <- recode(CatLotData3$NeighCat, 'c("Kitsap Lake", "West Bremerton") = "West Bremerton"; c("Charleston", "Bremerton") = "Bremerton";')
View(CatLotData3)
summary(CatLotData3$NeighCat)
qf(0.99, 13, 246)
CatFit6<-lm(PRICE~LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit6)
CatFit6<-lm(PRICE~LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit2)
anova(CatFit1, CatFit2)
CatFit3<-lm(PRICE~BATHS+BEDS+`SQUARE FEET`+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit3)
anova(CatFit1,CatFit3)
CatFit4<-lm(PRICE~BATHS+BEDS+`SQUARE FEET`+`YEAR BUILT`+ LotCat, data=CatLotData3)
summary(CatFit4)
anova(CatFit1,CatFit4)
CatFit5<-lm(PRICE~BATHS+`SQUARE FEET`+`YEAR BUILT`+ LotCat+ NeighCat2, data=CatLotData3)
summary(CatFit5)
anova(CatFit1, CatFit5)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit2)
anova(CatFit1, CatFit2)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit2)
anova(CatFit1, CatFit2)
CatFit3<-lm(PRICE~BATHS+BEDS+`SQUARE FEET`+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit3)
anova(CatFit1,CatFit3)
CatFit4<-lm(PRICE~BATHS+BEDS+`SQUARE FEET`+`YEAR BUILT`+ LotCat, data=CatLotData3)
summary(CatFit4)
anova(CatFit1,CatFit4)
CatFit5<-lm(PRICE~BATHS+`SQUARE FEET`+`YEAR BUILT`+ LotCat+ NeighCat2, data=CatLotData3)
summary(CatFit5)
anova(CatFit1, CatFit5)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit2)
anova(CatFit1, CatFit2)
CatFit6<-lm(PRICE~LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit6)
anova(CatFit1, CatFit6)
CatFit2<-lm(PRICE~BATHS+`SQUARE FEET`+LotCat+`YEAR BUILT`+ NeighCat2, data=CatLotData3)
summary(CatFit2)
anova(CatFit1, CatFit2)
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
install.packages("readr","tidyr","dplyr")
library(readr)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = normalizePath("C:/Users/randa/Dropbox/Masters/Autumn/TBANLT 540 Applied Regression Analysis/Categorical Variables Lab"))
Annual_Salary_2010_thru_2013 <- read_csv("Annual_Salary_2010_thru_2013.csv")
knitr::opts_knit$set(root.dir = normalizePath("C:/Users/randa/Dropbox/Masters/Autumn/TBANLT 540 Applied Regression Analysis/MSBA Final"))
Annual_Salary_2010_thru_2013 <- read_csv("Annual_Salary_2010_thru_2013.csv")
View(Annual_Salary_2010_thru_2013)
library(tidyr)
Annual_Salary_2010_thru_2013_long <- Annual_Salary_2010_thru_2013 %>%
pivot_longer(
starts_with("Salary"),
names_to = "Year",
values_to = "Salary"
)
library(dplyr)
Annual_Salary_2010_thru_2013_long_Clean <- Annual_Salary_2010_thru_2013_long %>%
select(AgencyTitle,EmployeeName,JobTitle,Year,Salary) %>% mutate(Year=substring(Year,7,11))
Annual_Salary_2010_thru_2013_long_Clean
write.csv(x=Annual_Salary_2010_thru_2013_long_Clean,file="Annual_Salary_2010_thru_2013_long_Clean.csv")
```{}
View(Annual_Salary_2010_thru_2013)
Annual_Salary_2010_thru_2013_long_Cleanwrite.json(x=Annual_Salary_2010_thru_2013_long_Clean,file="Annual_Salary_2010_thru_2013_long_Clean.json")
summary(Annual_Salary_2010_thru_2013)
count(Annual_Salary_2010_thru_2013)
Annual_Salary_2010_thru_2013_long_Clean <- read.csv("Annual_Salary_2010_thru_2013_long_Clean.csv")
count(Annual_Salary_2010_thru_2013_long_Clean)
library(readxl)
library(plyr)
library(tidyverse)
library(car)
count(Annual_Salary_2010_thru_2013_long_Clean)
count(Annual_Salary_2010_thru_2013_long_Clean)
View(Annual_Salary_2010_thru_2013_long)
View(Annual_Salary_2010_thru_2013_long_Clean)
CategoricalDataVar1 <- Annual_Salary_2010_thru_2013_long_Clean %>% select(AgencyTitle,EmployeeName,JobTitle,Year,Salary)
show(CategoricalDataVar1)
data(CategoricalDataVar1$Salary != 0)
data(CategoricalDataVar1$Salary == 0)
show(CategoricalDataVar1)
CategoricalDataVar2 <- -CategoricalDataVar1[CategoricalDataVar1$Salary=="0"]
CategoricalDataVar2 <- -CategoricalDataVar1[CategoricalDataVar1$Salary==0]
CategoricalDataVar2 <- -CategoricalDataVar1[CategoricalDataVar1$Salary=='0']
CategoricalDataVar2 <- -CategoricalDataVar1[!CategoricalDataVar1$Salary=='0']
CategoricalDataVar2<-CategoricalDataVar1[!(CategoricalDataVar1$Salary=="George"),]
CategoricalDataVar2<-CategoricalDataVar1[!(CategoricalDataVar1$Salary=="0"),]
show(CategoricalDataVar2)
summary(CategoricalDataVar2)
summary(CategoricalDataVar2)
hist(CategoricalDataVar2$`Salary`)
hist(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees" , xlim=1000000 )
hist(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees" , xlim="1000000")
hist(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees")
hist(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees", xlim="1000000")
hist(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees", xlim=c(100,1000000))
hist(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees", xlim=(100,1000000))
CategoricalDataVar2$LotCat<-cut(CategoricalDataVar2$`Salary`, c(0, 12468,37481,39883,56818 ,2736431,Inf))
hist(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees", xlim=c(100,1000000))
(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees", xlim=c(100,100000))
0
hist(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees", xlim=c(100,1000000))
hist(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees", xlim=c(100,100000))
hist(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees", xlim=c(100,100000), breaks = 5)
hist(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees", xlim=c(100,1000000), breaks = 5)
hist(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees", xlim=c(100,1000000), ylim =c(100,1000) breaks = 5)
hist(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees", xlim=c(100,1000000), ylim =c, breaks = 5)
hist(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees", xlim=c(100,1000000), ylim=c, breaks = 5)
hist(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees")
hist(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees", breaks = 3)
hist(CategoricalDataVar2$`AgencyTitle`, main = "Salaries of State Employees", breaks = 3)
hist(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees", breaks = 30)
hist(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees", xlim = c(0,100))
hist(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees", xlim = c(0,100000))
hist(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees", xlim = c(0,100000), ylim = c(0,10000))
hist(CategoricalDataVar2$`Salary`, main = "Salaries of State Employees")
install.packages("ggplot2")
install.packages("plotly")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = normalizePath("C:/Users/randa/Dropbox/Masters/Autumn/TBANLT 540 Applied Regression Analysis/MSBA Final"))
library(ggplot2)
library(plotly)
install.packages("plotly")
library(plotly)
p <- gapminder %>%
filter(year==1977) %>%
ggplot( aes(SALARY, Year, color=AgencyTitle)) +
geom_point() +
theme_bw()
p <- gapminder %>%
filter(year==1977) %>%
ggplot( aes(SALARY, Year, color=AgencyTitle)) +
geom_point() +
theme_bw()
Annual_Salary_2010_thru_2013_long_Clean <- gapminder %>%
filter(year==1977) %>%
ggplot( aes(SALARY, Year, color=AgencyTitle)) +
geom_point() +
theme_bw()
library(gapminder)
install.packages("gapminder")
library(gapminder)
p <- gapminder %>%
filter(year==1977) %>%
ggplot( aes(SALARY, Year, color=AgencyTitle)) +
geom_point() +
theme_bw()
ggplotly(p)
Annual_Salary_2010_thru_2013_long_Clean <- gapminder %>%
filter(year==1977) %>%
ggplot( aes(SALARY, Year, color=AgencyTitle)) +
geom_point() +
theme_bw()
ggplotly(Annual_Salary_2010_thru_2013_long_Clean)
Annual_Salary_2010_thru_2013_long_Clean <- gapminder %>%
filter(year==1977) %>%
ggplot( aes(salary, year, color=AgencyTitle)) +
geom_point() +
theme_bw()
ggplotly(Annual_Salary_2010_thru_2013_long_Clean)
Annual_Salary_2010_thru_2013_long_Clean <- gapminder %>%
filter(year==1977) %>%
ggplot( aes(Salary, year, color=AgencyTitle)) +
geom_point() +
theme_bw()
ggplotly(Annual_Salary_2010_thru_2013_long_Clean)
Annual_Salary_2010_thru_2013_long_Clean <- gapminder %>%
filter(Year==2013) %>%
ggplot( aes(Salary, Year, color=AgencyTitle)) +
geom_point() +
theme_bw()
p <- gapminder %>%
View(p)
Annual_Salary_2010_thru_2013_long_CleanGapminder <- gapminder %>%
Annual_Salary_2010_thru_2013_long_CleanGapminder <- gapminder %>%
Annual_Salary_2010_thru_2013_long_CleanGapminder <- gapminder %>%
filter(Year==2013) %>%
ggplot( aes(Salary, Year, color=AgencyTitle)) +
geom_point() +
theme_bw()
